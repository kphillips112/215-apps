<h1>My Food Calculator</h1>

<form [formGroup]="foodForm" (ngSubmit)="addFood()">
  <mat-grid-list [cols]="columns" rowHeight="80px">
    <mat-grid-tile [colspan]="1" [rowspan]="1">
      <mat-form-field>
        <input matInput placeholder="Food" formControlName="foodName" />
      </mat-form-field>
    </mat-grid-tile>
    <mat-grid-tile [colspan]="1" [rowspan]="1">
      <mat-form-field>
        <input matInput placeholder="Calories" formControlName="calories" />
      </mat-form-field>
    </mat-grid-tile>
    <mat-grid-tile [colspan]="1" [rowspan]="1">
      <mat-form-field>
        <input matInput placeholder="Count" formControlName="units" />
      </mat-form-field>
    </mat-grid-tile>
    <mat-grid-tile>
      <mat-form-field>
        <mat-label>Unit Type</mat-label>
        <select matNativeControl id="unitType" formControlName="unitType">
          <option *ngFor="let unitType of unitTypes">{{ unitType }}</option>
        </select>
      </mat-form-field>
    </mat-grid-tile>
    <mat-grid-tile [colspan]="1" [rowspan]="1">
      <mat-form-field>
        <input matInput placeholder="Price" formControlName="price" />
      </mat-form-field>
    </mat-grid-tile>
    <mat-grid-tile [colspan]="1" [rowspan]="1">
      <button mat-raised-button color="primary" type="submit">Add</button>
    </mat-grid-tile>
  </mat-grid-list>
</form>
<h2>Food list</h2>
<table mat-table [dataSource]="dataSource" class="mat-elevation-z8">
  <ng-container matColumnDef="foodName">
    <th mat-header-cell *matHeaderCellDef>Name</th>
    <td mat-cell *matCellDef="let element">{{ element.foodName }}</td>
  </ng-container>
  <ng-container matColumnDef="calories">
    <th mat-header-cell *matHeaderCellDef>Calories</th>
    <td mat-cell *matCellDef="let element">{{ element.calories }}</td>
  </ng-container>
  <ng-container matColumnDef="units">
    <th mat-header-cell *matHeaderCellDef>Units</th>
    <td mat-cell *matCellDef="let element">
      <mat-form-field
        ><input
          matInput
          type="number"
          [(ngModel)]="element.units"
          (ngModelChange)="updateFoodData()"
      /></mat-form-field>
    </td>
  </ng-container>
  <ng-container matColumnDef="unitType">
    <th mat-header-cell *matHeaderCellDef>Unit Type</th>
    <td mat-cell *matCellDef="let element">{{ element.unitType }}</td>
  </ng-container>
  <ng-container matColumnDef="price">
    <th mat-header-cell *matHeaderCellDef>Price</th>
    <td mat-cell *matCellDef="let element">{{ element.price }}</td>
  </ng-container>
  <ng-container matColumnDef="kilojoules">
    <th mat-header-cell *matHeaderCellDef>KJ</th>
    <td mat-cell *matCellDef="let element">{{ element.kilijoules }}</td>
  </ng-container>
  <ng-container matColumnDef="lowCal">
    <th mat-header-cell *matHeaderCellDef>LowCal</th>
    <td mat-cell *matCellDef="let element">
      <button
        mat-flat-button
        color="primary"
        (click)="element.makeLowCal(); updateFoodData()"
      ></button>
    </td>
  </ng-container>
  <ng-container matColumnDef="trimCal">
    <th mat-header-cell *matHeaderCellDef>Trim</th>
    <td mat-cell *matCellDef="let element">
      <button
        mat-flat-button
        color="primary"
        (click)="element.makeLowCal(10); updateFoodData()"
      ></button>
    </td>
  </ng-container>
  <ng-container matColumnDef="delete">
    <th mat-header-cell *matHeaderCellDef>Delete</th>
    <td mat-cell *matCellDef="let i = index">
      <button mat-flat-button color="warn" (click)="deleteFood(i)">
        Delete {{ i }}
      </button>
    </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
  <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
</table>
<div id="recipe-data" *ngIf="tableContainsData">
  <p>Calories: {{ totalCalories }}</p>
  <p>Price: {{ totalPrice }}</p>
  <button mat-raised-button color="primary" (click)="clearTable()">
    Delete All
  </button>
</div>
